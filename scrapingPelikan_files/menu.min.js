define(['jquery','mage/menu',],function($){'use strict';$.widget('penheaven.menu',$.mage.menu,{options:{openDelayTimer:300,uiStateActiveSelector:'.ui-state-active',uiStateActiveClass:'ui-state-active',submenuReverseClass:'submenu-reverse',transitionTime:100,uiMenuSelector:'.ui-menu',activeUiAnchorSelector:'a.ui-state-active',mediaBreakpoint:'(max-width: 990px)'},navOverlayElement:'.modal-overlay.nav-overlay',openTimer:'',_toggleDesktopMode:function(){this._super();$(this.element).off('mouseenter');this._on({'mouseenter .level-top.ui-menu-item':function(event){var target=$(event.currentTarget),submenu=this.options.menus,ulElement,ulElementWidth,width,targetPageX,rightBound;if(target.has(submenu)){ulElement=target.find(submenu);ulElementWidth=ulElement.outerWidth(true);width=target.outerWidth()*2;targetPageX=target.offset().left;rightBound=$(window).width();if(ulElementWidth+width+targetPageX>rightBound){ulElement.addClass(this.options.submenuReverseClass);}
if(targetPageX-ulElementWidth<0){ulElement.removeClass(this.options.submenuReverseClass);}}
target.siblings().children(this.options.uiStateActiveSelector).removeClass(this.options.uiStateActiveClass);this.openTimer=this._delay(function(){this.focus(event,target);},this.options.openDelayTimer);},'mouseleave .level-top.ui-menu-item':function(){if(this.openTimer){clearTimeout(this.openTimer);}}});},_toggleMobileMode:function(){this._super();$(this.element).off('click');this._on({'click .ui-state-disabled > a':function(event){event.preventDefault();},'click .ui-menu-item:has(a)':function(event){var target=$(event.target).closest('.ui-menu-item');event.preventDefault();if(!this.mouseHandled&&target.not('.ui-state-disabled').length){this.select(event);if(!event.isPropagationStopped()){this.mouseHandled=true;}
if(target.has('.ui-menu').length){this.expand(event);}else if(!this.element.is(':focus')&&$(this.document[0].activeElement).closest('.ui-menu').length){this.element.trigger('focus',[true]);if(this.active&&this.active.parents('.ui-menu').length===1){clearTimeout(this.timer);}}}
if(!target.hasClass('level-top')||!target.has('.ui-menu').length){window.location.href=target.find('> a').attr('href');}},'click .ui-menu-item:has(.ui-state-active)':function(event){this.collapseAll(event);}});},_open:function(submenu){this._super(submenu);},_close:function(startMenu){this._super(startMenu);}});return $.penheaven.menu;});