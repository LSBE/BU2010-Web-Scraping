(function(){'use strict';var helpers={hasClass:function(el,className){var regexp=new RegExp('(^|\\s+)'+className+'(\\s+|$)');return regexp.test(el.className);},addClass:function(el,className){if(!this.hasClass(el,className)){el.className=el.className?[el.className,className].join(' '):className;}},removeClass:function(el,className){var regexp;if(this.hasClass(el,className)){regexp=new RegExp('(^|\\s+)'+className+'(\\s+|$)');el.className=el.className.replace(regexp,'');}},extend:function(to,from){for(var item in from){if(from.hasOwnProperty(item)){to[item]=from[item];}}},getBrowserEventName:function(eventNames){var element=document.createElement('ddmenu'),name='';for(name in eventNames){if(element.style[name]!==undefined){return eventNames[name];}}
return false;}};helpers.transitionEnd=(function(){return helpers.getBrowserEventName({WebkitTransition:'webkitTransitionEnd',MozTransition:'transitionend',OTransition:'oTransitionEnd otransitionend',transition:'transitionend'});})();helpers.animationEnd=(function(){return helpers.getBrowserEventName({WebkitAnimation:'webkitAnimationEnd',MozAnimation:'animationend',OAnimation:'oAnimationEnd oanimationend',animation:'animationend'});})();function DDMenu(menuEl,options){var that=this;this.menuEl=menuEl;this.opt=options;this.buttonEl=document.querySelector(menuEl.getAttribute('data-button'));this.overlay=null;this.helpers=helpers;this.listeners={};this.afterOpenCallback=function(){if(that.helpers.transitionEnd){that.menuEl.removeEventListener(that.helpers.transitionEnd,that.afterOpenCallback,false);}
that.dispatchEvent('afterOpen');};if(this.buttonEl){this.buttonEl.addEventListener('click',function(e){e.preventDefault();if(document.getElementsByClassName('catalog-category-view stickyfilter').length){document.querySelectorAll('#amasty-shopby-product-list .sorter-container')[0].classList.add("lowerZindex");document.querySelectorAll('#amasty-shopby-product-list .toolbar-products')[0].classList.add("lowerZindex");}
that.open();},false);}
this.setupCloseButton();}
DDMenu.prototype={addListener:function(eventName,listener){if(!this.listeners[eventName]){this.listeners[eventName]=[];}
this.listeners[eventName].push(listener);},removeListener:function(eventName,listener){var listeners,i;if(!this.listeners[eventName]){return;}
listeners=this.listeners[eventName];for(i=0;i<listeners.length;i++){if(listeners[i]===listener){listeners.splice(i,1);break;}}},dispatchEvent:function(eventName){var listeners,i;if(!this.listeners[eventName]){return;}
listeners=this.listeners[eventName];for(i=0;i<listeners.length;i++){listeners[i].apply(this);}},addOverlay:function(){var that=this;if(!this.overlay){this.overlay=document.createElement('div');this.overlay.setAttribute('id','dd-menu-overlay');document.body.appendChild(this.overlay);this.overlay.addEventListener('click',function(e){e.preventDefault();that.close();},false);}
this.overlay.style.display='block';this.overlay.offsetWidth;this.helpers.addClass(this.overlay,'open');},removeOverlay:function(){var that=this;var complete=function(){if(that.helpers.transitionEnd){that.overlay.removeEventListener(that.helpers.transitionEnd,complete);}
that.overlay.style.display='none';};if(this.helpers.transitionEnd){this.overlay.addEventListener(this.helpers.transitionEnd,complete);}else{complete();}
this.overlay.classList.remove('open');},open:function(){this.addOverlay();switch(this.opt.effect){case'slideFromLeft':this.slideFrom('left');break;case'slideFromRight':this.slideFrom('right');break;}},setupCloseButton:function(){var that=this;this.menuEl.addEventListener('click',function(e){if(e.target&&e.target.className.search('dd-menu-close')===-1){return;}
if(document.getElementsByClassName('catalog-category-view stickyfilter').length){document.querySelectorAll('#amasty-shopby-product-list .sorter-container')[0].classList.remove("lowerZindex");document.querySelectorAll('#amasty-shopby-product-list .toolbar-products')[0].classList.remove("lowerZindex");}
that.close();},false);},slideFrom:function(from){var width,transform,opacity,that=this;this.menuEl.style.visibility='hidden';this.menuEl.style.opacity=0;this.menuEl.style.display='block';width=this.menuEl.offsetWidth;if(from==='left'){this.menuEl.style.left='-'+width+'px';transform='translate3d('+width+'px, 0, 0)';}else{this.menuEl.style.left='100%';transform='translate3d(-'+width+'px, 0, 0)';}
this.menuEl.style.visibility='visible';this.dispatchEvent('beforeOpen');if(this.helpers.transitionEnd){this.menuEl.addEventListener(this.helpers.transitionEnd,this.afterOpenCallback,false);}
requestAnimationFrame(function(){that.menuEl.style.transition='transform 0.3s ease, opacity 0.3s ease';that.menuEl.style.transform=transform;that.menuEl.style.opacity=1;if(!that.helpers.transitionEnd){this.afterOpenCallback();}});},close:function(){var that=this;var complete=function(){this.removeEventListener(that.helpers.transitionEnd,complete,false);this.style.transition='';this.style.display='none';};this.menuEl.addEventListener(this.helpers.transitionEnd,complete,false);this.menuEl.style.transform='';this.menuEl.style.opacity=0;this.removeOverlay();}};window.getDDMenu=function(menuEl,options){var item;var defaults={effect:'slideFromRight'};if(!options){options={};}
helpers.extend(defaults,options);return new DDMenu(menuEl,options);};})();(function(){'use strict';function DDMenuItems(ddMenu){var that=this;this.ddMenu=ddMenu;this.stack=[];this.beforeOpen=function(){that.reset();that.prepareAnimation();};this.afterOpen=function(){that.startAnimation();};this.maybeSubMenu=function(e){if(e.target.nodeName=='A'){that.maybeOpenSubmenu(e.target);}};this.prevMenu=function(){that.switchMenu('prev');};this.ddMenu.addListener('beforeOpen',this.beforeOpen);this.ddMenu.addListener('afterOpen',this.afterOpen);this.ddMenu.menuEl.addEventListener('click',this.maybeSubMenu,false);this.ddMenu.menuEl.querySelector('.dd-menu-prev').addEventListener('click',this.prevMenu,false);}
DDMenuItems.prototype={getTitle:function(){return this.ddMenu.menuEl.querySelector('.dd-menu-title').innerHTML;},setTitle:function(newTitle){var titleEl=this.ddMenu.menuEl.querySelector('.dd-menu-title');titleEl.innerHTML=newTitle;},reset:function(){var currentMenu,firstMenu,helpers;if(this.stack.length>=2){firstMenu=this.stack[0].menu;firstMenu.style.display='block';firstMenu.style.opacity=1;currentMenu=this.stack[this.stack.length-1].menu;currentMenu.style.display='none';this.setTitle(this.stack[0].title);helpers=this.ddMenu.helpers;helpers.removeClass(this.ddMenu.menuEl,'level-'+this.stack.length);helpers.addClass(this.ddMenu.menuEl,'level-1');}
this.stack=[];},prepareAnimation:function(menu){var items,i;if(!menu){menu=this.ddMenu.menuEl.querySelector('.dd-menu-items');this.stack.push({menu:menu,title:this.getTitle()});}
items=menu.querySelectorAll('.dd-menu-item');for(i=0;i<items.length;i++){items[i].style.transition='';items[i].style.opacity=0;items[i].style.transform='translate3d(-100%, 0, 0)';}},startAnimation:function(){var currentMenu=this.stack[this.stack.length-1];var items=currentMenu.menu.querySelectorAll('.dd-menu-item');var i;for(i=0;i<items.length;i++){items[i].style.transition='transform .4s ease, opacity .4s ease';items[i].style.transitionDelay=(100*i)+'ms';items[i].style.opacity=1;items[i].style.transform='translate3d(0, 0, 0)';}},switchMenu:function(dir,menu,title){var that=this;var transitionEnd=this.ddMenu.helpers.transitionEnd;var currentMenu;var prevMenu;var complete;var curLevel=this.stack.length;if(dir=='prev'){if(this.stack.length<=1){return;}
currentMenu=this.stack.pop();prevMenu=this.stack[this.stack.length-1];menu=prevMenu.menu;title=prevMenu.title;}else{currentMenu=this.stack[this.stack.length-1];this.stack.push({menu:menu,title:title});}
complete=function(){if(transitionEnd){this.removeEventListener(transitionEnd,complete,false);}
currentMenu.menu.style.display='none';menu.style.display='block';menu.style.opacity=1;that.prepareAnimation(menu);menu.offsetWidth;that.startAnimation();};if(title){this.setTitle(title);}
this.ddMenu.helpers.removeClass(this.ddMenu.menuEl,'level-'+curLevel);this.ddMenu.helpers.addClass(this.ddMenu.menuEl,'level-'+this.stack.length);if(transitionEnd){currentMenu.menu.addEventListener(transitionEnd,complete,false);currentMenu.menu.style.transition='opacity .3s ease';currentMenu.menu.style.opacity=0;}else{complete();}},maybeOpenSubmenu:function(link){var submenuId=link.getAttribute('data-submenu');var submenu;if(!submenuId){return;}
submenu=document.getElementById(submenuId);this.switchMenu('next',submenu,link.innerHTML);}};window.DDMenuItems=DDMenuItems;})();