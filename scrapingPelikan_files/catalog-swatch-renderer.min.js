define(['uiComponent','ko','jquery','underscore',],function(Component,ko,$,_){'use strict';return Component.extend({isVisible:false,showMoreVisible:false,renderedSwatches:null,swatchWidth:28,defaultSwatchCount:5,initialize:function(config){this._super(config);this.bindUIActions();this.bindReloadEvent();this.processSwatchesToRender();this.isVisible(true);},initObservable:function(){this._super();this.observe(['isVisible','showMoreVisible','renderedSwatches']);return this;},bindUIActions:function(){var self=this,updateLayout=_.debounce(function(){self.processSwatchesToRender();},500);window.addEventListener('resize',updateLayout,false);},bindReloadEvent:function(){var self=this;$("."+this.name).bind('reloadSwatches',function(){self.processSwatchesToRender();});},processSwatchesToRender:function(){var elementWidth=$("."+this.name).width(),maxSwatchToRender=Math.floor((elementWidth-50)/ this.swatchWidth);if(elementWidth===0){maxSwatchToRender=this.defaultSwatchCount;}
if(!this.renderedSwatches()||(this.renderedSwatches()&&maxSwatchToRender!==this.renderedSwatches().length)){this.refreshRenderedSwatchesArray(maxSwatchToRender);}},refreshRenderedSwatchesArray:function(max){var configs=[],i;for(i=0;i<max;i++){if(this.swatchAttributeConfigs[i]){configs.push(this.swatchAttributeConfigs[i]);}}
if(this.swatchAttributeConfigs.length&&configs.length<this.swatchAttributeConfigs.length){this.showMoreVisible(true);}else{this.showMoreVisible(false);}
this.renderedSwatches(configs);}});});